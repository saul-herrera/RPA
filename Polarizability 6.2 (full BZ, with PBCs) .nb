(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     98292,       2252]
NotebookOptionsPosition[     95629,       2204]
NotebookOutlinePosition[     96121,       2223]
CellTagsIndexPosition[     96078,       2220]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",ExpressionUUID->"bff85224-bb18-4b30-a812-19ac33705938"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", "2.46"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "a", " ", "is", " ", "given", " ", "in", " ", "units", " ", "of", " ", 
    RowBox[{"10", "^", 
     RowBox[{"-", "10"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", "\[Pi]"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sqrt]", "3"}], "*", "a"}], ")"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Magnitude", " ", "of", " ", "reciprocal", " ", "vectors"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b1", "=", 
    RowBox[{"b", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Sqrt]", "3"}], ")"}], "/", "2."}], ",", 
       RowBox[{"1", "/", "2."}]}], "}"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Reciprocal", " ", "vectors", " ", "b1"}], ",", "b2"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", "=", 
   RowBox[{"b", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"\[Sqrt]", "3"}]}], ")"}], "/", "2."}], ",", 
      RowBox[{"1", "/", "2."}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b3", "=", 
   RowBox[{"(", 
    RowBox[{"b1", "+", "b2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{
    FractionBox["1", "3."], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "  ", "b1"}], "+", "b2"}], ")"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kp", "=", 
    RowBox[{
     FractionBox["1", "3."], 
     RowBox[{"(", 
      RowBox[{"b1", "-", "b2"}], ")"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "5"}], ";", 
   RowBox[{"(*", 
    RowBox[{"Nk", "=", 
     RowBox[{"3", 
      SuperscriptBox["n", "2"]}]}], "*)"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"n", " ", "=", " ", 
     RowBox[{
     "number", " ", "of", " ", "points", " ", "that", " ", "the", " ", "mesh",
       " ", "of", " ", "the", " ", "full", " ", "1", "BZ", " ", 
      RowBox[{"(", 
       RowBox[{
       "with", " ", "same", " ", "\[CapitalDelta]k", " ", "distance"}], ")"}],
       " ", "would", " ", "have"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"\[Delta]n", "=", "n"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"\[Delta]n", " ", "=", " ", 
      RowBox[{"parameter", " ", "analogous", " ", "to", " ", "n"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"but", " ", "for", " ", "the", " ", "mini"}], "-", "kmesh"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"\[Lambda]", "=", 
    RowBox[{"(", 
     RowBox[{"n", "-", "\[Delta]n"}], ")"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "\[Lambda]", " ", "is", " ", "used", " ", "when", " ", "generating", " ", 
     "the", " ", "meshes"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Nq", "=", "n"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"Nq", " ", "=", " ", 
     RowBox[{
     "is", " ", "the", " ", "number", " ", "of", " ", "q", " ", "points", " ",
       "for", " ", "which", " ", "\[CapitalPi]", 
      RowBox[{"(", "q", ")"}], " ", "will", " ", "be", " ", "calculated"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"iqf", ",", "jqf"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "Nq"}], "}"}]}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "indices", " ", "of", " ", "the", " ", "vector", " ", 
      "pointing", " ", "to", " ", "the", " ", "end", " ", "of", " ", "the", 
      " ", "q"}], "-", "path"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "move", " ", "in", " ", "other", " ",
       "direction"}], ",", " ", 
     RowBox[{
     "it", " ", "might", " ", "be", " ", "convenient", " ", "to", " ", 
      "project", " ", "j", " ", "along", " ", "other", " ", "kp", " ", 
      "vector"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i0", ",", "j0"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"Center", " ", "of", " ", "k", " ", "mesh"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "function", " ", "transltes", " ", "from", " ", "indices", 
      " ", "i"}], ",", 
     RowBox[{"j", " ", "to", " ", 
      RowBox[{"vectors", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndexToVector", "[", "kij_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sol", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"kij", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "n"], 
            RowBox[{"{", 
             RowBox[{"kk", ",", "kp"}], "}"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "kij", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"kij", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "functions", " ", "P1"}], ",", "P2", ",", 
    RowBox[{
    "P3", " ", "give", " ", "the", " ", "projections", " ", "of", " ", "k", 
     " ", "along", " ", "b1"}], ",", " ", "b2", ",", " ", 
    RowBox[{"b3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"working", " ", "with", " ", "indices", " ", "i"}], ",", "j"}],
       ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P3", "[", "kij_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "n3", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"n3", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", ">", "n"}], ",", 
          RowBox[{
           RowBox[{"+", "1"}], " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "n"}], ",", 
             RowBox[{"-", "n"}]}], "}"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "<=", 
             RowBox[{"-", "n"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "n"}], ",", 
               RowBox[{"-", "n"}]}], "}"}]}], ",", "0"}], "]"}]}], "]"}], 
        "&"}], " ", ",", " ", 
       RowBox[{"kij", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", "[", "kij_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "n2", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"n2", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", " ", ">", "0"}], " ", "&&", " ", 
            RowBox[{"#2", " ", "<=", " ", 
             RowBox[{"-", "n"}]}]}], "  ", ",", 
           RowBox[{"+", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{
               RowBox[{"-", "2"}], "n"}]}], "}"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#2", ">", "n"}], " ", "&&", " ", 
              RowBox[{"#1", "<=", " ", "0"}]}], ",", " ", 
             RowBox[{"-", 
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{
                 RowBox[{"-", "2"}], "n"}]}], "}"}]}], ",", "0"}], "]"}]}], 
          "]"}], "&"}], ",", "kij", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P1", "[", "kij_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "n1", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"n1", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#1", "+", "#2"}], " ", ">", " ", "n"}], " ", "&&", " ", 
            
            RowBox[{"#1", ">", "0"}]}], "  ", ",", 
           RowBox[{"+", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#1", "+", "#2"}], "<=", 
               RowBox[{"-", "n"}]}], " ", "&&", " ", 
              RowBox[{"#1", "<=", " ", "0"}]}], ",", " ", 
             RowBox[{"-", 
              RowBox[{"{", 
               RowBox[{"n", ",", "n"}], "}"}]}], ",", "0"}], "]"}]}], "]"}], 
         "&"}], " ", ",", "kij", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "kij", " ", "the", " ", "indices", " ", "of", " ", "the", " ", "vectors", 
     " ", "in", " ", "the", " ", "k"}], "-", 
    RowBox[{"mesh", ":"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k0ij", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "sol", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "+", "i0"}], ",", 
          RowBox[{"j", "+", "j0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "-", "i"}]}], "]"}],
            "+", "1"}], ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "\[Lambda]"}], ")"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "\[Lambda]"}], ")"}], "-", "i"}]}], "]"}]}], 
         "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k0mesh", "=", 
    RowBox[{"IndexToVector", "[", "k0ij", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"To", " ", "ilustrate", " ", "the", " ", "PBCs"}], ",", " ", 
    RowBox[{"we", " ", "define", " ", "two", " ", "meshes"}], ",", " ", 
    RowBox[{
    "kqij", " ", "with", " ", "vectors", " ", "outside", " ", "1", "BZ"}], 
    ",", " ", 
    RowBox[{
    "and", " ", "kpij", " ", "with", " ", "all", " ", "vectors", " ", "in", 
     " ", "1", "BZ", " ", "after", " ", "applying", " ", "PBCs"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kqij", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "sol", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "+", "i0"}], ",", 
          RowBox[{"j", "+", "1", "+", "j0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "-", "i"}]}], "]"}],
            "+", "1"}], ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "\[Lambda]"}], ")"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "\[Lambda]"}], ")"}], "-", "i"}]}], "]"}]}], 
         "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kqmesh", "=", 
    RowBox[{"IndexToVector", "[", "kqij", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kpij", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", "k0ij", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kqijP3", "=", 
   RowBox[{"kqij", "-", 
    RowBox[{"P3", "[", "kqij", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kpij", "=", 
   RowBox[{"kqijP3", "-", 
    RowBox[{"P1", "[", "kqijP3", "]"}], "-", 
    RowBox[{"P2", "[", "kqijP3", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kpmesh", "=", 
    RowBox[{"IndexToVector", "[", "kpij", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"StringForm", "[", 
  RowBox[{"\"\<Total number of k-points to be diagonalized: ``.\>\"", ",", 
   RowBox[{"Length", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"k0ij", ",", "1"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.862674285962473*^9, 3.86267428637036*^9}, {
   3.86267435362222*^9, 3.862674353789792*^9}, {3.8626744636494303`*^9, 
   3.86267448283556*^9}, {3.86267959348772*^9, 3.862679594573414*^9}, {
   3.862679650009617*^9, 3.862679652215661*^9}, {3.86267972644281*^9, 
   3.862679726986055*^9}, {3.8626806012193413`*^9, 3.862680611815988*^9}, {
   3.8626824258673477`*^9, 3.862682427613895*^9}, {3.8626829680534267`*^9, 
   3.8626829915657177`*^9}, {3.8626838465891123`*^9, 3.862683847056178*^9}, {
   3.862756902767334*^9, 3.862756902952046*^9}, {3.8629305272123404`*^9, 
   3.862930528770055*^9}, {3.862930566323765*^9, 3.86293059089235*^9}, {
   3.862930645058115*^9, 3.86293064805613*^9}, {3.862930684995138*^9, 
   3.8629306856813717`*^9}, {3.862930818358917*^9, 3.862930944667411*^9}, {
   3.862931041269312*^9, 3.862931130216523*^9}, {3.8629311681702547`*^9, 
   3.86293125610463*^9}, {3.862931300055469*^9, 3.8629313366752033`*^9}, {
   3.862931379840774*^9, 3.862931453059704*^9}, 3.862931504822485*^9, {
   3.862931559256955*^9, 3.862931617066388*^9}, {3.8629358676853313`*^9, 
   3.862935870699757*^9}, {3.862939987655115*^9, 3.862939988714258*^9}, {
   3.8629400388447113`*^9, 3.8629400430206842`*^9}, {3.862940232173891*^9, 
   3.862940232297374*^9}, {3.86294060672097*^9, 3.86294077233184*^9}, {
   3.86294095461543*^9, 3.862940965847335*^9}, {3.8629410401050577`*^9, 
   3.8629410408026876`*^9}, {3.8629412422316113`*^9, 3.8629413559798527`*^9}, 
   3.86294143049085*^9, {3.8629432262318583`*^9, 3.862943339761039*^9}, {
   3.8630000828211317`*^9, 3.863000095324793*^9}, {3.863782789291079*^9, 
   3.863782789581352*^9}, {3.863783296359776*^9, 3.8637832979398108`*^9}, {
   3.863783994658244*^9, 3.863783994889818*^9}, {3.863784227856045*^9, 
   3.863784271128745*^9}, {3.8637843427400913`*^9, 3.8637843550924997`*^9}, {
   3.86378439531946*^9, 3.863784399654149*^9}, {3.863784457753643*^9, 
   3.8637844591121817`*^9}, {3.863784491163314*^9, 3.863784494297681*^9}, {
   3.863785611599226*^9, 3.8637856120977173`*^9}, {3.8637856624452343`*^9, 
   3.863785665363201*^9}, {3.863785894281492*^9, 3.863785970963231*^9}, {
   3.8637860248854113`*^9, 3.8637860467157373`*^9}, {3.863786265556246*^9, 
   3.8637862910907*^9}, {3.863786321190731*^9, 3.863786342121146*^9}, {
   3.863871811764677*^9, 3.863871816045712*^9}, {3.8638718474643917`*^9, 
   3.86387184762313*^9}, {3.8638718936247873`*^9, 3.8638718937678213`*^9}, {
   3.8638759537570267`*^9, 3.863875967903389*^9}, {3.863883562119898*^9, 
   3.8638835996311073`*^9}, {3.8638836804620543`*^9, 3.863883683148485*^9}, {
   3.864143653045597*^9, 3.864143680606721*^9}, {3.864143764307043*^9, 
   3.86414381588335*^9}, {3.864143968274643*^9, 3.864143969433544*^9}, {
   3.8641440237543383`*^9, 3.864144038745961*^9}, {3.864144099013667*^9, 
   3.864144102483325*^9}, {3.864144847724935*^9, 3.864144849875242*^9}, {
   3.8641453573402987`*^9, 3.864145404717884*^9}, {3.864145439687523*^9, 
   3.864145665910366*^9}, {3.864145742493091*^9, 3.864145743888152*^9}, {
   3.864146243354035*^9, 3.864146282235189*^9}, {3.864146328033002*^9, 
   3.864146390445013*^9}, {3.864146476321926*^9, 3.864146508304328*^9}, {
   3.864146549212707*^9, 3.8641465504203053`*^9}, {3.864146580860901*^9, 
   3.864146585109387*^9}, {3.864146646374975*^9, 3.864146660253974*^9}, {
   3.8641469548654737`*^9, 3.86414697925852*^9}, {3.8641473165815487`*^9, 
   3.864147387742317*^9}, {3.864147481778879*^9, 3.864147628893292*^9}, {
   3.864147881207829*^9, 3.864147907542498*^9}, {3.8641480719973497`*^9, 
   3.864148189358241*^9}, {3.864148238384004*^9, 3.864148316481958*^9}, {
   3.864148402750464*^9, 3.864148487367257*^9}, 3.864149575087319*^9, {
   3.864149605851654*^9, 3.864149623939783*^9}, {3.8642143577060947`*^9, 
   3.864214358159843*^9}, {3.86421551417127*^9, 3.864215524419581*^9}, {
   3.8642165061220083`*^9, 3.864216507615793*^9}, {3.8642170125833883`*^9, 
   3.864217059630609*^9}, {3.864217091000045*^9, 3.864217131440754*^9}, {
   3.864219553265518*^9, 3.864219589972414*^9}, {3.864219630094132*^9, 
   3.864219674792021*^9}, {3.864219794179555*^9, 3.8642198182602587`*^9}, 
   3.8642198520026217`*^9, {3.864230107164342*^9, 3.864230121412486*^9}, {
   3.864230387358897*^9, 3.864230394451222*^9}, {3.86423062968412*^9, 
   3.864230630003899*^9}, {3.864230960808094*^9, 3.864230962255423*^9}, {
   3.864231539443531*^9, 3.864231539746369*^9}, {3.864233053795185*^9, 
   3.864233054100082*^9}, 3.864233191323542*^9, {3.864234195315742*^9, 
   3.8642341956271667`*^9}, {3.864234297296851*^9, 3.864234331038872*^9}, {
   3.8642367183693323`*^9, 3.8642367200148487`*^9}, {3.864299639198824*^9, 
   3.864299640596633*^9}, {3.864304457523281*^9, 3.8643044585057487`*^9}, {
   3.864304516085803*^9, 3.8643046270012627`*^9}, {3.864304732367076*^9, 
   3.8643048579746532`*^9}, {3.864304911514311*^9, 3.864304923273962*^9}, {
   3.8643050265264177`*^9, 3.8643050268204947`*^9}, {3.8643050702494917`*^9, 
   3.864305101791143*^9}, {3.864305132057763*^9, 3.864305132175729*^9}, {
   3.864305233117776*^9, 3.864305233868167*^9}, {3.864305266581221*^9, 
   3.864305290533757*^9}, {3.8643053550573187`*^9, 3.864305355358059*^9}, {
   3.8643055682573757`*^9, 3.864305568415584*^9}, {3.864305633306158*^9, 
   3.864305633808461*^9}, {3.864305664132284*^9, 3.864305699355962*^9}, {
   3.864305738076598*^9, 3.864305791062546*^9}, {3.864305894125515*^9, 
   3.864306097105792*^9}, {3.8643061277007313`*^9, 3.864306149763433*^9}, {
   3.8643061901285753`*^9, 3.864306309560948*^9}, {3.864306348277131*^9, 
   3.864306350779647*^9}, {3.864306454224062*^9, 3.864306479894376*^9}, {
   3.864306797243121*^9, 3.864306820842125*^9}, {3.864313466425886*^9, 
   3.864313471584793*^9}, {3.864313538107082*^9, 3.864313580228622*^9}, {
   3.864313694870769*^9, 3.8643137043212337`*^9}, {3.8643137354979677`*^9, 
   3.8643137542338667`*^9}, {3.864313787974608*^9, 3.864313864020697*^9}, {
   3.864313898840548*^9, 3.864313899293941*^9}, {3.864313983890975*^9, 
   3.8643139937865868`*^9}, {3.8643140255855923`*^9, 
   3.8643140944832478`*^9}, {3.864315395823352*^9, 3.864315396060647*^9}, {
   3.864315679118793*^9, 3.86431568554191*^9}, {3.86431571712119*^9, 
   3.8643157196305637`*^9}, {3.864316179049654*^9, 3.864316212606954*^9}, {
   3.8643162755481377`*^9, 3.8643162815066967`*^9}, {3.8643163425348263`*^9, 
   3.864316342932231*^9}, {3.864317243923877*^9, 3.864317298251542*^9}, {
   3.86431757358867*^9, 3.864317723851049*^9}, {3.86431775473175*^9, 
   3.864317812404008*^9}, {3.8643178718892517`*^9, 3.864318124608261*^9}, {
   3.864318188339038*^9, 3.864318210801231*^9}, {3.8643182462976913`*^9, 
   3.864318288115821*^9}, {3.864319919419508*^9, 3.864319941154669*^9}, {
   3.8643214044864607`*^9, 3.864321490893173*^9}, 3.8643215712106953`*^9, {
   3.864321607921803*^9, 3.8643218017670383`*^9}, {3.864321842866963*^9, 
   3.864321851497574*^9}, {3.864321916037506*^9, 3.86432204422486*^9}, {
   3.8643221067877913`*^9, 3.864322216004326*^9}, {3.864322259142189*^9, 
   3.864322272639369*^9}, {3.864322303794783*^9, 3.8643223995540113`*^9}, {
   3.864322430331621*^9, 3.8643224326674967`*^9}, {3.864323266081976*^9, 
   3.86432333769296*^9}, {3.8643234355577993`*^9, 3.8643234455969133`*^9}, {
   3.864323597847598*^9, 3.864323602735304*^9}, {3.8643885677543077`*^9, 
   3.864388584202059*^9}, {3.864389274682207*^9, 3.86438927493609*^9}, {
   3.864389673771925*^9, 3.8643896738869133`*^9}, {3.8643907438386917`*^9, 
   3.864390747971973*^9}, {3.864390787383999*^9, 3.864390787469472*^9}, {
   3.864398350870513*^9, 3.864398350971651*^9}, {3.864398742794898*^9, 
   3.8643987432801027`*^9}, {3.8643990524054213`*^9, 3.864399053850895*^9}, {
   3.8643997398918858`*^9, 3.8643997425934153`*^9}, {3.864484536635556*^9, 
   3.8644845647065353`*^9}, {3.864484851709758*^9, 3.864484863291801*^9}, {
   3.8644852021616383`*^9, 3.864485202406825*^9}, {3.864486127156046*^9, 
   3.864486137940742*^9}, {3.864486180089438*^9, 3.864486228088215*^9}, {
   3.864486272155704*^9, 3.8644863064986153`*^9}, {3.864486634645821*^9, 
   3.8644866458860683`*^9}, {3.864487655395838*^9, 3.864487657415551*^9}, {
   3.864488955330627*^9, 3.864488961553146*^9}, {3.864488997806139*^9, 
   3.864488999958659*^9}, 3.864489048070178*^9, {3.864489485923682*^9, 
   3.864489497147143*^9}, {3.864489669300179*^9, 3.864489689641217*^9}, {
   3.864489810638967*^9, 3.864489839397999*^9}, {3.864489880733778*^9, 
   3.86448991123743*^9}, {3.864489954962826*^9, 3.864489955282013*^9}, {
   3.864490152858836*^9, 3.8644901533124027`*^9}, {3.864490430420133*^9, 
   3.8644904507380733`*^9}, {3.8644908839784517`*^9, 3.86449088803327*^9}, {
   3.864491147052277*^9, 3.864491147153064*^9}, {3.86449152467304*^9, 
   3.864491527421607*^9}, {3.864491562938451*^9, 3.864491563055147*^9}, {
   3.86449203102667*^9, 3.864492035646615*^9}, {3.864492195646885*^9, 
   3.864492484638125*^9}, {3.86449269335126*^9, 3.86449279052804*^9}, {
   3.864747795836174*^9, 3.86474780351517*^9}, {3.8647478476291924`*^9, 
   3.8647479120792913`*^9}, {3.864748051005872*^9, 3.864748095565481*^9}, {
   3.864748249422893*^9, 3.864748252652294*^9}, {3.864748354943445*^9, 
   3.8647485378935757`*^9}, {3.864748616728793*^9, 3.8647486201051903`*^9}, 
   3.864748670171564*^9, {3.864748701298546*^9, 3.8647487145316772`*^9}, {
   3.864748777135613*^9, 3.864748799837934*^9}, {3.86474910803465*^9, 
   3.864749108336134*^9}, {3.864749407060409*^9, 3.864749420268667*^9}, {
   3.8647494611010437`*^9, 3.8647494676760902`*^9}, {3.8647495490451517`*^9, 
   3.864749597903221*^9}, {3.864749629956479*^9, 3.864749683758133*^9}, {
   3.8647497167662582`*^9, 3.864749725420042*^9}, {3.8647506856619463`*^9, 
   3.864750687088045*^9}, {3.864750934209733*^9, 3.864750935150107*^9}, 
   3.8647510221401367`*^9, {3.8647510625630198`*^9, 3.864751082065243*^9}, 
   3.864751175862015*^9, {3.864751572971149*^9, 3.864751575481304*^9}, {
   3.86475567038097*^9, 3.8647557372622137`*^9}, {3.86475586975491*^9, 
   3.8647558702082253`*^9}, {3.864755921283485*^9, 3.8647559222501183`*^9}, {
   3.864816415700638*^9, 3.864816442250211*^9}, {3.864816500025279*^9, 
   3.864816500222324*^9}, {3.8648165455789337`*^9, 3.864816545976149*^9}, {
   3.864816901558947*^9, 3.864816902708116*^9}, {3.864843401680373*^9, 
   3.864843407290722*^9}, {3.864843459016687*^9, 3.8648435634282217`*^9}},
 Background->RGBColor[1, 0.9, 1],
 CellLabel->"In[53]:=",ExpressionUUID->"abb95b15-8003-42ef-9f07-b46c5ca7ad24"],

Cell[BoxData[
 InterpretationBox["\<\"Total number of k-points to be diagonalized: \
\\!\\(\\*RowBox[{\\\"75\\\"}]\\).\"\>",
  StringForm["Total number of k-points to be diagonalized: ``.", 75],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.864492747820457*^9, 3.8644927913140182`*^9, 3.8644929864302*^9, {
   3.864747867061737*^9, 3.86474791517874*^9}, {3.864748051607531*^9, 
   3.8647480960037622`*^9}, 3.864748508662671*^9, 3.864748546012156*^9, 
   3.8647486209408903`*^9, {3.8647486557332373`*^9, 3.864748671105837*^9}, {
   3.8647487101079807`*^9, 3.864748715826182*^9}, 3.864748778292376*^9, 
   3.864748876763298*^9, 3.864749109542117*^9, {3.8647494078751783`*^9, 
   3.8647494206271133`*^9}, 3.8647495759599047`*^9, {3.864749619624658*^9, 
   3.864749684260743*^9}, 3.864749725844644*^9, {3.864750667907208*^9, 
   3.864750713885269*^9}, 3.864750937210824*^9, 3.864751023382711*^9, {
   3.864751070757145*^9, 3.864751083329424*^9}, 3.864751182418988*^9, 
   3.864752339460086*^9, 3.8647557639366093`*^9, 3.864756747940436*^9, 
   3.8648164210544243`*^9, 3.864816501910104*^9, 3.864816547380889*^9, 
   3.864843410149775*^9, 3.864843460998376*^9, 3.8648435737551413`*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"43057a04-f22f-4c9e-a1bc-80bf732c5b6d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.864748647891082*^9, 3.864748652273535*^9}, 
   3.864755680004678*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c0aad437-a457-4357-80e5-79dd5f270198"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Drawing", " ", "the", " ", "contours", " ", "and", " ", "vectors", " ", 
    "of", " ", "the", " ", "1", "BZ", " ", "for", " ", "the", " ", 
    RowBox[{"figures", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BZcontour", " ", "=", " ", 
     RowBox[{"Polygon", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[Pi]"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"3", "a"}], ")"}]}], ")"}], "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[Pi]"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"3", "a"}], ")"}]}], ")"}], "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Sqrt]", "3"}], ")"}], "/", "2"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[Pi]"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"3", "a"}], ")"}]}], ")"}], "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Sqrt]", "3"}], ")"}], "/", "2"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[Pi]"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"3", "a"}], ")"}]}], ")"}], "*", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[Pi]"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"3", "a"}], ")"}]}], ")"}], "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{"\[Sqrt]", "3"}]}], ")"}], "/", "2"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[Pi]"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"3", "a"}], ")"}]}], ")"}], "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{"\[Sqrt]", "3"}]}], ")"}], "/", "2"}]}], "}"}]}]}], 
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps", "=", "0.015"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BZvectors", " ", "=", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Red", ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "kk"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "Blue", ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "kp"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "b1"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "b2"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", " ", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<b1\>\"", ",", 
          RowBox[{"b1", "*", "1.05"}]}], "]"}], ",", "\[IndentingNewLine]", 
        "Black", ",", " ", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<b2\>\"", ",", 
          RowBox[{"b2", "*", "1.05"}]}], "]"}], ",", "\[IndentingNewLine]", 
        "Red", ",", " ", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<K\>\"", ",", 
          RowBox[{"kk", "*", "1.1"}]}], "]"}], ",", "\[IndentingNewLine]", 
        "Blue", ",", " ", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<K'\>\"", ",", 
          RowBox[{"kp", "*", "1.1"}]}], "]"}], ",", "\[IndentingNewLine]", 
        "Red", ",", 
        RowBox[{"Opacity", "[", "0.1", "]"}], ",", 
        RowBox[{"EdgeForm", " ", "[", "Dashed", "]"}], ",", "BZcontour"}], 
       "\[IndentingNewLine]", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Plotting", " ", "the", " ", "k", " ", 
     RowBox[{"mesh", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"\"\<k0 mesh:\>\"", ",", 
          RowBox[{"0.6", "b3"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PointSize", "[", "ps", "]"}], ",", "\[IndentingNewLine]", 
        "Green", ",", "\[IndentingNewLine]", 
        RowBox[{"Point", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"k0mesh", ",", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]",
        "}"}], "]"}], ",", "\[IndentingNewLine]", "BZvectors"}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"\"\<kq mesh:\>\"", ",", 
          RowBox[{"0.6", "b3"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PointSize", "[", "ps", "]"}], ",", "\[IndentingNewLine]", 
        "Green", ",", "\[IndentingNewLine]", 
        RowBox[{"Point", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"kqmesh", ",", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]",
        "}"}], "]"}], ",", "\[IndentingNewLine]", "BZvectors"}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"\"\<kp mesh:\>\"", ",", 
          RowBox[{"0.6", "b3"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PointSize", "[", "ps", "]"}], ",", "\[IndentingNewLine]", 
        "Green", ",", "\[IndentingNewLine]", 
        RowBox[{"Point", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"kpmesh", ",", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]",
        "}"}], "]"}], ",", "\[IndentingNewLine]", "BZvectors"}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.862674299652667*^9, 3.862674302972539*^9}, 
   3.862674333807592*^9, {3.862674364085435*^9, 3.862674383900894*^9}, {
   3.86267450322622*^9, 3.8626745276188517`*^9}, {3.862674830359029*^9, 
   3.862674830653285*^9}, {3.862676855437949*^9, 3.862676922810973*^9}, {
   3.862677381841856*^9, 3.862677563961059*^9}, 3.8626778738549347`*^9, {
   3.8626782244661093`*^9, 3.8626783530741587`*^9}, {3.86268378198872*^9, 
   3.862683784316812*^9}, {3.862684216819923*^9, 3.862684220386889*^9}, {
   3.862930224025002*^9, 3.8629302825951653`*^9}, {3.862930378351014*^9, 
   3.862930519931843*^9}, {3.862930658953676*^9, 3.862930659320498*^9}, {
   3.862930764060082*^9, 3.8629307692046757`*^9}, {3.862931268074216*^9, 
   3.862931270751876*^9}, {3.8629313465000887`*^9, 3.862931361362918*^9}, {
   3.862931462513112*^9, 3.862931474526719*^9}, {3.862935879191538*^9, 
   3.862935885404955*^9}, {3.862940138609819*^9, 3.86294013915265*^9}, {
   3.8629408999590597`*^9, 3.8629409487450113`*^9}, {3.862940992491578*^9, 
   3.862941026931303*^9}, {3.8629410574298573`*^9, 3.8629411103254347`*^9}, {
   3.86294209373413*^9, 3.8629422442496223`*^9}, {3.862942293167181*^9, 
   3.862942420065164*^9}, {3.862942471085737*^9, 3.862942638164156*^9}, {
   3.862942906428195*^9, 3.862942932453204*^9}, {3.8629430773653812`*^9, 
   3.862943080994047*^9}, {3.862943348293982*^9, 3.862943433188899*^9}, {
   3.863000179210308*^9, 3.8630002631156073`*^9}, 3.863785975613521*^9, {
   3.863786349558775*^9, 3.8637863507662992`*^9}, {3.8641457749067*^9, 
   3.8641457949610777`*^9}, {3.864145845798748*^9, 3.864145846731*^9}, {
   3.864149594100613*^9, 3.864149595506674*^9}, {3.864149638637546*^9, 
   3.864149642132018*^9}, {3.864221091706208*^9, 3.864221092551824*^9}, {
   3.8642300994061747`*^9, 3.864230099722096*^9}, {3.864230157724444*^9, 
   3.864230159803791*^9}, {3.864304867358617*^9, 3.864304892311458*^9}, {
   3.8643049658823137`*^9, 3.864305006091714*^9}, {3.8643051945253897`*^9, 
   3.864305211250121*^9}, {3.864305802950798*^9, 3.8643058489923077`*^9}, {
   3.864313498410521*^9, 3.864313505921316*^9}, {3.864314112163142*^9, 
   3.864314140555794*^9}, {3.864314311717613*^9, 3.864314326881605*^9}, {
   3.864314425538015*^9, 3.864314431781722*^9}, {3.864315038768837*^9, 
   3.8643151837828827`*^9}, {3.8643152242520847`*^9, 3.864315224416006*^9}, {
   3.86431528841687*^9, 3.864315299552874*^9}, {3.864315447674568*^9, 
   3.864315447767055*^9}, {3.8643156975782146`*^9, 3.864315707685824*^9}, {
   3.8643157667630253`*^9, 3.8643157698561563`*^9}, {3.8643162200343723`*^9, 
   3.86431624476721*^9}, {3.8643163098928337`*^9, 3.8643163263062887`*^9}, {
   3.864484601637925*^9, 3.864484659700056*^9}, {3.864484736729995*^9, 
   3.8644847375450993`*^9}, {3.864484806828479*^9, 3.8644848346296597`*^9}, {
   3.864484950542925*^9, 3.864484966400176*^9}, {3.864485052162587*^9, 
   3.864485089019848*^9}, {3.864485147361709*^9, 3.864485147782155*^9}, {
   3.86448575761782*^9, 3.8644857581392717`*^9}, {3.8644857886646357`*^9, 
   3.864485790315435*^9}, {3.86448611207631*^9, 3.864486113507712*^9}, {
   3.8644862415794563`*^9, 3.864486244696081*^9}, {3.8644863254049263`*^9, 
   3.8644863530849648`*^9}, {3.864486475976976*^9, 3.8644866045964603`*^9}, {
   3.864486656395196*^9, 3.864486669823762*^9}, {3.8644890600478067`*^9, 
   3.864489062801371*^9}, {3.864489123281062*^9, 3.864489141887515*^9}, 
   3.864489179854439*^9, {3.864489624912236*^9, 3.8644896520073853`*^9}, {
   3.8644928073147717`*^9, 3.864492815312826*^9}, {3.8647485180767527`*^9, 
   3.864748524667017*^9}, {3.864748682682591*^9, 3.864748691232264*^9}, {
   3.864755790269785*^9, 3.8647557935855503`*^9}, {3.864840734748926*^9, 
   3.864840769627297*^9}, {3.86484343438031*^9, 3.8648434395601883`*^9}},
 Background->RGBColor[0.9, 1, 1],
 CellLabel->"In[73]:=",ExpressionUUID->"593f9408-4163-46e8-9494-92e77893cb3a"],

Cell[BoxData[
 GraphicsBox[{{InsetBox["\<\"k0 mesh:\"\>", {0., 1.7695603553504562}], 
    {RGBColor[0, 1, 0], PointSize[0.015], PointBox[CompressedData["
1:eJxdk7FKQ0EQRR9WNrHQCAoqiIWNhR8g3g+wEavUoq0iKNgGFIv8gAQ/Q2wX
ESu7YPqwEBBUCCsPAzYqb2dgz4MQDrO7zLnMrB+eHhzPVFW19/f7/7/bORv0
X8ZhYdrvtEcpNDx0rvKHukoeO198vq7edybOT73WTXf3Paycv12t7X/k+si5
uf9MFs475/ecZxc3Ljfnv3B+kvuPofSL8Ivwi/CL8Ivws3rtnPvJ7w/c39j8
jc0fLJwX3nM2f+Pto7A1dz1V+V7tnpaPseVT8tCZn+WD+86WT1mvnZv+f5yR
l5CXkJeQl5CXkJeQl5CXkJcwP8L8CPPjHqgL950xP8L8CPsi7IuwL8K+CPsi
7IuwL/BL8EvwS/BL8EvwS97/0sPjyfLtt/cPlrH1b2z9G/8CpEFHcw==
      "]]}}, {
    {RGBColor[1, 0, 0], 
     ArrowBox[{{0, 0}, {0.851380122924063, 1.4746336294587135`}}]}, 
    {RGBColor[0, 0, 1], ArrowBox[{{0, 0}, {1.702760245848126, 0.}}]}, 
    {GrayLevel[0], 
     ArrowBox[{{0, 0}, {2.554140368772189, 1.4746336294587135`}}]}, 
    {GrayLevel[0], 
     ArrowBox[{{0, 0}, {-2.554140368772189, 1.4746336294587135`}}]}, 
    {GrayLevel[0], 
     InsetBox["\<\"b1\"\>", {2.681847387210799, 1.548365310931649}]}, 
    {GrayLevel[0], 
     InsetBox["\<\"b2\"\>", {-2.681847387210799, 1.548365310931649}]}, 
    {RGBColor[1, 0, 0], 
     InsetBox["\<\"K\"\>", {0.9365181352164693, 1.622096992404585}]}, 
    {RGBColor[0, 0, 1], InsetBox["\<\"K'\"\>", {1.8730362704329386, 0.}]}, 
    {RGBColor[1, 0, 0], Opacity[0.1], EdgeForm[Dashing[{Small, Small}]], 
     PolygonBox[{{-1.7027602458481266`, 0.}, {-0.8513801229240633, 
      1.4746336294587137`}, {0.8513801229240633, 1.4746336294587137`}, {
      1.7027602458481266`, 0.}, {
      0.8513801229240633, -1.4746336294587137`}, {-0.8513801229240633, \
-1.4746336294587137`}}]}}}]], "Output",
 CellChangeTimes->{
  3.864489142840877*^9, {3.8644891805663013`*^9, 3.86448918189723*^9}, 
   3.864489507168878*^9, {3.864489659379093*^9, 3.864489697579666*^9}, {
   3.864489815142074*^9, 3.8644898444169397`*^9}, 3.864489958610799*^9, {
   3.8644901586584806`*^9, 3.864490161998795*^9}, {3.864490435743101*^9, 
   3.864490456293318*^9}, 3.864490891691181*^9, 3.864491151320513*^9, {
   3.86449153814215*^9, 3.8644915672197027`*^9}, 3.864492041445343*^9, 
   3.864492817717648*^9, 3.864492987519429*^9, {3.8647478698883867`*^9, 
   3.864747900535033*^9}, {3.8647480553788757`*^9, 3.864748098858873*^9}, 
   3.864748549592371*^9, 3.864748677494458*^9, 3.86474871894037*^9, 
   3.8647487844546347`*^9, {3.8647488731479197`*^9, 3.8647488808640537`*^9}, 
   3.864749115341895*^9, {3.864750693339653*^9, 3.8647507206078176`*^9}, 
   3.864751090242325*^9, {3.864755769621522*^9, 3.864755796782351*^9}, 
   3.864816447221427*^9, 3.8648165522343607`*^9, 3.864840770537305*^9, 
   3.864843417108203*^9, 3.864843462866352*^9, 3.8648435750731363`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"42f2a8e5-fecc-4c8c-b290-a2497832d2b3"],

Cell[BoxData[
 GraphicsBox[{{InsetBox["\<\"kq mesh:\"\>", {0., 1.7695603553504562}], 
    {RGBColor[0, 1, 0], PointSize[0.015], PointBox[CompressedData["
1:eJxdk71KA1EQRhcrGy38AQUVxMLGwgcQP3sbsZCAnZhWERRsBcXCF5DgWyi2
FxEru2D6eCEgRCFcDQmIoMKdgXsWluUwd3fnfMws7h1u10eqqtr8u/+fN2tH
zcZzK0wOG7WpdgpVvoxzXSV3nE8+Xubvaj3U+6i3w9zx2/nC1nuuP5FlnM87
P16NXZ6td51Hp5dOlyc+nVf3w8r4xVDl9zrZJ4bSL8Ivwi/CL8Ivwi/m/r7B
3fy/pvsbmz9YOO9s/sbmb2z+xju3u69fgx98r+felk/JLWdelg/ed7Z8ynrf
2fIpz1cbZd3zEvIS8hLyEvIS8hLyEvIS8hLmR5gf90BdJfv8CPMjzI8wP8K+
CPsi7IuwL8K+CPsi7Av8EvwS/BL8EvwS/JL3P3P/cDB7PfD+ja1/Y+vf2Po3
/gVNGkNL
      "]]}}, {
    {RGBColor[1, 0, 0], 
     ArrowBox[{{0, 0}, {0.851380122924063, 1.4746336294587135`}}]}, 
    {RGBColor[0, 0, 1], ArrowBox[{{0, 0}, {1.702760245848126, 0.}}]}, 
    {GrayLevel[0], 
     ArrowBox[{{0, 0}, {2.554140368772189, 1.4746336294587135`}}]}, 
    {GrayLevel[0], 
     ArrowBox[{{0, 0}, {-2.554140368772189, 1.4746336294587135`}}]}, 
    {GrayLevel[0], 
     InsetBox["\<\"b1\"\>", {2.681847387210799, 1.548365310931649}]}, 
    {GrayLevel[0], 
     InsetBox["\<\"b2\"\>", {-2.681847387210799, 1.548365310931649}]}, 
    {RGBColor[1, 0, 0], 
     InsetBox["\<\"K\"\>", {0.9365181352164693, 1.622096992404585}]}, 
    {RGBColor[0, 0, 1], InsetBox["\<\"K'\"\>", {1.8730362704329386, 0.}]}, 
    {RGBColor[1, 0, 0], Opacity[0.1], EdgeForm[Dashing[{Small, Small}]], 
     PolygonBox[{{-1.7027602458481266`, 0.}, {-0.8513801229240633, 
      1.4746336294587137`}, {0.8513801229240633, 1.4746336294587137`}, {
      1.7027602458481266`, 0.}, {
      0.8513801229240633, -1.4746336294587137`}, {-0.8513801229240633, \
-1.4746336294587137`}}]}}}]], "Output",
 CellChangeTimes->{
  3.864489142840877*^9, {3.8644891805663013`*^9, 3.86448918189723*^9}, 
   3.864489507168878*^9, {3.864489659379093*^9, 3.864489697579666*^9}, {
   3.864489815142074*^9, 3.8644898444169397`*^9}, 3.864489958610799*^9, {
   3.8644901586584806`*^9, 3.864490161998795*^9}, {3.864490435743101*^9, 
   3.864490456293318*^9}, 3.864490891691181*^9, 3.864491151320513*^9, {
   3.86449153814215*^9, 3.8644915672197027`*^9}, 3.864492041445343*^9, 
   3.864492817717648*^9, 3.864492987519429*^9, {3.8647478698883867`*^9, 
   3.864747900535033*^9}, {3.8647480553788757`*^9, 3.864748098858873*^9}, 
   3.864748549592371*^9, 3.864748677494458*^9, 3.86474871894037*^9, 
   3.8647487844546347`*^9, {3.8647488731479197`*^9, 3.8647488808640537`*^9}, 
   3.864749115341895*^9, {3.864750693339653*^9, 3.8647507206078176`*^9}, 
   3.864751090242325*^9, {3.864755769621522*^9, 3.864755796782351*^9}, 
   3.864816447221427*^9, 3.8648165522343607`*^9, 3.864840770537305*^9, 
   3.864843417108203*^9, 3.864843462866352*^9, 3.864843575147478*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"ab91bef5-e111-4dd4-bb5b-19e5b42d4d3e"],

Cell[BoxData[
 GraphicsBox[{{InsetBox["\<\"kp mesh:\"\>", {0., 1.7695603553504562}], 
    {RGBColor[0, 1, 0], PointSize[0.015], PointBox[CompressedData["
1:eJxdk71KA1EQhRcrGy38AQUVxMLGwgcQzwPYiFVq0VYJKNgKioUvIMHHENuL
iJVdMH1YEAQVwpVgwEYl9wzst7AsHzN7d87ZM6v7x3uHE1VV7fzd/8/brXa3
89xLs6NOa66fU1Uuc6mrya/Bp58vy3etQfDk/NrZ+sxXOa+rcb2flk7eLlZ2
P8r7T2SZS3/w4/XU1fn2e3A5H/2D8r1aZT5zauqroa+Gvhr6auhzfRhc5rMe
mYt+6wm2frDQH2z9Zus3bx6kjenLkZrnWX+W/bFu15vcC+Zlf/B+sP1p1ofB
4/l/0N9PC/cPR4s33/RL8EvwS/BL8EvwS/BL8At5yfDPeYr8hA7UhfwFIz9C
foT8JOyLsC/Cvgj7IuyLsC/CvmA/MvRl6MvQl6EvC/sfeff/9vxmz488qNk/
jHz+AuNAR3M=
      "]]}}, {
    {RGBColor[1, 0, 0], 
     ArrowBox[{{0, 0}, {0.851380122924063, 1.4746336294587135`}}]}, 
    {RGBColor[0, 0, 1], ArrowBox[{{0, 0}, {1.702760245848126, 0.}}]}, 
    {GrayLevel[0], 
     ArrowBox[{{0, 0}, {2.554140368772189, 1.4746336294587135`}}]}, 
    {GrayLevel[0], 
     ArrowBox[{{0, 0}, {-2.554140368772189, 1.4746336294587135`}}]}, 
    {GrayLevel[0], 
     InsetBox["\<\"b1\"\>", {2.681847387210799, 1.548365310931649}]}, 
    {GrayLevel[0], 
     InsetBox["\<\"b2\"\>", {-2.681847387210799, 1.548365310931649}]}, 
    {RGBColor[1, 0, 0], 
     InsetBox["\<\"K\"\>", {0.9365181352164693, 1.622096992404585}]}, 
    {RGBColor[0, 0, 1], InsetBox["\<\"K'\"\>", {1.8730362704329386, 0.}]}, 
    {RGBColor[1, 0, 0], Opacity[0.1], EdgeForm[Dashing[{Small, Small}]], 
     PolygonBox[{{-1.7027602458481266`, 0.}, {-0.8513801229240633, 
      1.4746336294587137`}, {0.8513801229240633, 1.4746336294587137`}, {
      1.7027602458481266`, 0.}, {
      0.8513801229240633, -1.4746336294587137`}, {-0.8513801229240633, \
-1.4746336294587137`}}]}}}]], "Output",
 CellChangeTimes->{
  3.864489142840877*^9, {3.8644891805663013`*^9, 3.86448918189723*^9}, 
   3.864489507168878*^9, {3.864489659379093*^9, 3.864489697579666*^9}, {
   3.864489815142074*^9, 3.8644898444169397`*^9}, 3.864489958610799*^9, {
   3.8644901586584806`*^9, 3.864490161998795*^9}, {3.864490435743101*^9, 
   3.864490456293318*^9}, 3.864490891691181*^9, 3.864491151320513*^9, {
   3.86449153814215*^9, 3.8644915672197027`*^9}, 3.864492041445343*^9, 
   3.864492817717648*^9, 3.864492987519429*^9, {3.8647478698883867`*^9, 
   3.864747900535033*^9}, {3.8647480553788757`*^9, 3.864748098858873*^9}, 
   3.864748549592371*^9, 3.864748677494458*^9, 3.86474871894037*^9, 
   3.8647487844546347`*^9, {3.8647488731479197`*^9, 3.8647488808640537`*^9}, 
   3.864749115341895*^9, {3.864750693339653*^9, 3.8647507206078176`*^9}, 
   3.864751090242325*^9, {3.864755769621522*^9, 3.864755796782351*^9}, 
   3.864816447221427*^9, 3.8648165522343607`*^9, 3.864840770537305*^9, 
   3.864843417108203*^9, 3.864843462866352*^9, 3.864843575231104*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"dbe9244a-d444-446f-841d-6cbab7fa997d"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.864755769391748*^9, 
  3.864816521584869*^9},ExpressionUUID->"c82ea273-31cb-4a12-a29e-\
1fc46c08bd57"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.864816523936531*^9},ExpressionUUID->"1e933596-729d-4d82-a4e5-\
9ab0df649604"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", "2.46"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "a", " ", "is", " ", "given", " ", "in", " ", "units", " ", "of", " ", 
    RowBox[{"10", "^", 
     RowBox[{"-", "10"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]0", "=", "3.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]1", "=", "0.38"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]2", "=", 
   RowBox[{"-", "0.015"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]3", "=", "0.29"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]4", "=", "0.141"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]", "=", 
   RowBox[{"-", "0.0105"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]1", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]2", "=", 
   RowBox[{"-", "0.0023"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
   RowBox[{"1.", "+", 
    RowBox[{"2.", "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"0.5", "*", "kx", "*", "a"}], "]"}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "*", "ky", "*", "a", "*", "0.5", "*", 
       SqrtBox["3"]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"\[ImaginaryI]", "*", "ky", "*", "a", "*", 
      SqrtBox["3"]}], "]"}], "*", 
    RowBox[{"u", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Hk", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[CapitalDelta]1", "+", "\[CapitalDelta]2"}], ",", 
        RowBox[{
         RowBox[{"-", "\[Gamma]0"}], "*", 
         RowBox[{"u", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{"\[Gamma]4", "*", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "\[Conjugate]"}]}], ",", 
        "\[Gamma]1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Gamma]0"}], "*", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "\[Conjugate]"}]}], ",", 
        RowBox[{
        "\[CapitalDelta]1", "+", "\[CapitalDelta]2", "+", "\[Delta]"}], ",", 
        RowBox[{"\[Gamma]3", "*", 
         RowBox[{"v", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{"\[Gamma]4", "*", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "\[Conjugate]"}]}], ",", 
        RowBox[{"0.5", "*", "\[Gamma]2"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Gamma]4", "*", 
         RowBox[{"u", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{"\[Gamma]3", "*", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "\[Conjugate]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "2."}], "*", "\[CapitalDelta]2"}], ",", 
        RowBox[{
         RowBox[{"-", "\[Gamma]0"}], "*", 
         RowBox[{"u", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{"\[Gamma]4", "*", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "\[Conjugate]"}]}], ",", 
        "\[Gamma]1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]1", ",", 
        RowBox[{"\[Gamma]4", "*", 
         RowBox[{"u", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "\[Gamma]0"}], "*", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "\[Conjugate]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "2."}], "*", "\[CapitalDelta]2"}], ",", 
        RowBox[{"\[Gamma]3", "*", 
         RowBox[{"u", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{"\[Gamma]4", "*", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "\[Conjugate]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"0.5", "*", "\[Gamma]2"}], ",", 
        RowBox[{"\[Gamma]4", "*", 
         RowBox[{"v", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{"\[Gamma]3", "*", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "\[Conjugate]"}]}], ",", 
        RowBox[{
        "\[CapitalDelta]2", "-", "\[CapitalDelta]1", "+", "\[Delta]"}], ",", 
        RowBox[{
         RowBox[{"-", "\[Gamma]0"}], "*", 
         RowBox[{"v", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Gamma]1", ",", 
        RowBox[{"\[Gamma]4", "*", 
         RowBox[{"u", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "\[Gamma]0"}], "*", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], "\[Conjugate]"}]}], ",", 
        RowBox[{"\[CapitalDelta]2", "-", "\[CapitalDelta]1"}]}], "}"}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "bands"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Nb", "=", 
    RowBox[{"Length", "[", 
     RowBox[{"Hk", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "]"}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{
  3.8642279838501043`*^9, {3.864230833105771*^9, 3.864230834835987*^9}, 
   3.864230892808222*^9, 3.8642309304828873`*^9, {3.864489475978986*^9, 
   3.86448947694676*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[79]:=",ExpressionUUID->"d355315d-1177-42f3-a64b-84b013f8f6ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]", "=", 
    RowBox[{"-", "0.052175"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"VHS", " ", "is", " ", "at", " ", "\[Mu]"}], "=", 
     RowBox[{"-", "0.052175"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kbT", "=", 
    RowBox[{"0.0000861", "*", "1"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Boltzmann", "'"}], "s", " ", 
    RowBox[{"k", " ", "\[Cross]", " ", "temperature"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]c", "=", 
    RowBox[{"10.", "*", "kbT"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"cutoff", " ", "for", " ", "the", " ", "Fermi"}], "-", 
    RowBox[{"Dirac", " ", "distribution"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDif", "[", "\[Epsilon]k_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"\[Mu]", "-", "\[Epsilon]k"}], "]"}], "<", "\[Delta]c"}], ",", 
     
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Epsilon]k", "-", "\[Mu]"}], ")"}], "/", "kbT"}], 
         "]"}]}], ")"}]}], ",", 
     RowBox[{"UnitStep", "[", 
      RowBox[{"\[Mu]", "-", "\[Epsilon]k"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]Fif", "[", "\[Epsilon]k_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"\[Mu]", "-", "\[Epsilon]k"}], "]"}], "<", "\[Delta]c"}], ",", 
     
     RowBox[{
      RowBox[{
       RowBox[{"-", "1."}], "/", "kbT"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cosh", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Epsilon]k", "-", "\[Mu]"}], ")"}], "/", "kbT"}], 
           "]"}]}], ")"}]}], ")"}]}], ",", "0."}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8637865411003933`*^9, 3.8637865627121*^9}, {
   3.863872100518324*^9, 3.863872100741426*^9}, {3.86414971624536*^9, 
   3.86414974680239*^9}, 3.864149862603382*^9, {3.864215898284436*^9, 
   3.864215910098707*^9}, {3.86449284167728*^9, 3.864492872241425*^9}},
 Background->RGBColor[1, 0.9, 1],
 CellLabel->"In[92]:=",ExpressionUUID->"bd4c15dd-fd08-4bf9-b336-d5d98f1ecea1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "These", " ", "arrays", " ", "hold", " ", "the", " ", "same", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "j"}], "}"}], " ", "structure", " ", "than", " ", 
    "kij"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ek0ij", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Eigenvalues", ",", 
       RowBox[{"Apply", "[", 
        RowBox[{"Hk", ",", "k0mesh", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]k0ij", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Eigenvectors", ",", 
       RowBox[{"Apply", "[", 
        RowBox[{"Hk", ",", "k0mesh", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nfEk0ij", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"UnitStep", "[", 
         RowBox[{"\[Mu]", "-", "#"}], "]"}], "&"}], ",", "Ek0ij", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ek", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Ek0ij", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{"(", 
               RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
             RowBox[{"#2", "-", "j0", "-", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "-", "#1"}]}], 
               "]"}]}]}], "]"}], "]"}], " ", "&"}], ",", "k0ij", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]k", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]k0ij", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{"(", 
               RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
             RowBox[{"#2", "-", "j0", "-", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "-", "#1"}]}], 
               "]"}]}]}], "]"}], "]"}], " ", "&"}], ",", "k0ij", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nfEk", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nfEk0ij", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#1", "+", 
              RowBox[{"(", 
               RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
             RowBox[{"#2", "-", "j0", "-", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "-", "#1"}]}], 
               "]"}]}]}], "]"}], "]"}], " ", "&"}], ",", "k0ij", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.864149950891309*^9, 3.864149983101802*^9}, {
   3.8641500549537067`*^9, 3.8641503798377323`*^9}, {3.864150430690426*^9, 
   3.864150589543154*^9}, 3.864150651026724*^9, {3.864150989691869*^9, 
   3.8641510133406153`*^9}, {3.864213527428933*^9, 3.864213527587844*^9}, {
   3.864213577021624*^9, 3.8642135772206984`*^9}, {3.8642137726198053`*^9, 
   3.864213805652357*^9}, {3.864214161687139*^9, 3.864214171374395*^9}, {
   3.864214246627542*^9, 3.864214330484314*^9}, {3.864214390471957*^9, 
   3.8642143932625303`*^9}, {3.864214433791717*^9, 3.864214442607766*^9}, {
   3.864215039703086*^9, 3.864215088040181*^9}, {3.864215143760477*^9, 
   3.864215499707468*^9}, {3.8642161046722507`*^9, 3.864216287055888*^9}, {
   3.864216345716168*^9, 3.864216350625297*^9}, {3.8642163949786167`*^9, 
   3.86421646830035*^9}, {3.864216525569353*^9, 3.8642166013919*^9}, {
   3.864216632531681*^9, 3.8642167435401297`*^9}, {3.864219992916572*^9, 
   3.864219997481657*^9}, {3.864230565584984*^9, 3.864230603377919*^9}, {
   3.864230657243535*^9, 3.8642306621159773`*^9}, {3.86423070766396*^9, 
   3.864230720645196*^9}, 3.8642307842577353`*^9, {3.864230912494693*^9, 
   3.864230976053966*^9}, 3.86423186024684*^9, {3.8642326349414177`*^9, 
   3.864232641093583*^9}, 3.864233357893703*^9, {3.864233399184401*^9, 
   3.8642334163612633`*^9}, {3.8642337372876596`*^9, 3.8642337426500874`*^9}, 
   3.864236176873205*^9, {3.8643146936280413`*^9, 3.864314695803193*^9}, {
   3.864314747285398*^9, 3.864314748365546*^9}, {3.8643161479621964`*^9, 
   3.864316157739757*^9}, {3.864316386915683*^9, 3.864316486830677*^9}, {
   3.864316521824836*^9, 3.864316526407147*^9}, {3.864316566324943*^9, 
   3.864316605258353*^9}, {3.864316681788576*^9, 3.86431675105612*^9}, {
   3.864316803190298*^9, 3.864316824906225*^9}, {3.8643168590349617`*^9, 
   3.864316886551325*^9}, {3.864316918287689*^9, 3.8643169890719767`*^9}, {
   3.864317167501214*^9, 3.864317220559209*^9}, 3.864317350745491*^9, {
   3.864317385228924*^9, 3.864317421597972*^9}, {3.8643175142656603`*^9, 
   3.864317517584993*^9}, {3.8643225257042313`*^9, 3.8643225547104*^9}, {
   3.864322586367597*^9, 3.864322587159348*^9}, {3.864322631084013*^9, 
   3.8643226444331427`*^9}, {3.86432271734105*^9, 3.8643227199089613`*^9}, {
   3.864322792201906*^9, 3.864322910929647*^9}, {3.864322956877812*^9, 
   3.8643230897653847`*^9}, {3.864323754479266*^9, 3.864323864198945*^9}, {
   3.864389147775803*^9, 3.8643891590132513`*^9}, {3.8644893833588467`*^9, 
   3.864489383942219*^9}, 3.8644928872787237`*^9, {3.864748902583364*^9, 
   3.864748995521903*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[97]:=",ExpressionUUID->"f27b4035-8b37-4f27-86ca-6c0753b92226"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Epath", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k0mesh", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", 
              RowBox[{"(", 
               RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", "ii"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Ek0ij", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", 
              RowBox[{"(", 
               RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", "ii"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"k0mesh", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", 
             RowBox[{"(", 
              RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "]"}], "]"}], "]"}]}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "Nb"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K0", "=", 
   RowBox[{"0.", " ", 
    RowBox[{"Norm", "[", "kp", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]K", "=", 
   RowBox[{"1.1", 
    RowBox[{"Norm", "[", "kp", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]E", "=", 
   RowBox[{"2", "\[Gamma]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"Epath", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"K0", "-", "\[Delta]K"}], ",", 
        RowBox[{"K0", "+", "\[Delta]K"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "\[Delta]E"}], ",", "\[Delta]E"}], "}"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.864216160999877*^9, 3.864216161006278*^9}, {
   3.864220003489914*^9, 3.8642200154718018`*^9}, {3.8643147591860237`*^9, 
   3.864314767598751*^9}, {3.8643149040524883`*^9, 3.864314919261088*^9}, {
   3.864315459839724*^9, 3.864315464236513*^9}, {3.864315506177945*^9, 
   3.864315510934208*^9}, {3.864315550570137*^9, 3.864315671755155*^9}, {
   3.864316498433138*^9, 3.864316499223743*^9}, {3.864389709103455*^9, 
   3.864389834305565*^9}, {3.864390056059822*^9, 3.864390056520954*^9}, {
   3.8643901387922363`*^9, 3.864390342692095*^9}, {3.8643991308537416`*^9, 
   3.864399141052805*^9}, {3.8643998264998827`*^9, 3.864399851154583*^9}, 
   3.864489313997754*^9, {3.864489386199527*^9, 3.864489392624014*^9}, {
   3.864489985698818*^9, 3.864490029354432*^9}, {3.864490830666363*^9, 
   3.864490831364595*^9}, {3.8644920656074142`*^9, 3.8644920657577972`*^9}, {
   3.864492905371793*^9, 3.864492915818296*^9}, {3.864748973282675*^9, 
   3.864748974121673*^9}, {3.864749008623056*^9, 3.8647490476827917`*^9}, {
   3.8647490874537697`*^9, 3.864749095860358*^9}, {3.864749147546966*^9, 
   3.864749149399262*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[103]:=",ExpressionUUID->"27b85d38-d1c7-43e8-b3df-4d23b1fa7169"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCwAWIQPcem8NKs01/3X37qlqaUwHEAxg/9fFeQ5SarA4yv
6FfH834lM1z+quELvtQeZri82MsZ9SnpjHB+kObx4prbf/eXvr0iuyXiw/6y
Yp+164+JH4DxLdLL7I4YijrA+GasBzP7RUTg8j1//y1cxCoCl1/vxn2s9b0Q
nP+Df8ZUvUQBqHue7u+Y8j1Q4YMCnB+acEujVVXOAcb/mtIVMJ1VFi5vfmjR
y6XfZODyf/4cfy9+WxrO3573QfiNmgRU/dX9t+/cu7EvVgXOF0yqz1gho+QA
48t9Ey15060Il+9wvN5R3KIIl3/yUHbasi8KcL6xk0r1+lzZAwxQsLrAY6nR
FFU4/3jdsQNX9ZUdYPygd/95bsxTgstPKvysFT9dCS6/+MUpxWtsCL7qxbl7
Gr3lYe6xR3O/PZr77dHcb4/mfns099vD3A8NL3u08LdHC397tPC3Rwt/e7Tw
t4eFPzS+7dHSjz1a+rFHSz/2aOnHHi392KOmn6/2aOnfHi3926Olf3u09G+P
lv7tYen/cDdve6Pdb3u3xXnlsRy37GH8iHLTBKlXN+HyR2xMhKfduQaXLyrn
jKtefw0uz13TfCvQYgOc33Otwt4odLE9AI3V5BA=
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{-1.8730362704329386`, 1.8730362704329386`}, {-6.2, 6.2}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.864489296912678*^9, 3.864489315118924*^9}, 
   3.864489394927978*^9, 3.8644895205570183`*^9, 3.8644897092300577`*^9, {
   3.864489831751408*^9, 3.864489851196775*^9}, {3.864489966473629*^9, 
   3.864490029888967*^9}, 3.8644901699253187`*^9, {3.864490439082604*^9, 
   3.864490465978939*^9}, 3.8644908326216593`*^9, 3.864490901790456*^9, 
   3.864491160405794*^9, {3.864491551067994*^9, 3.8644915756818438`*^9}, {
   3.86449205506111*^9, 3.864492066120719*^9}, {3.8644929058378277`*^9, 
   3.8644929164257593`*^9}, 3.864492998585847*^9, {3.864748999493132*^9, 
   3.864749048210443*^9}, {3.8647490881953917`*^9, 3.864749096798973*^9}, {
   3.864749132825953*^9, 3.864749150044738*^9}, 3.8647507425941153`*^9, 
   3.864751037647772*^9, {3.8647511165662107`*^9, 3.864751123653243*^9}, 
   3.864751204294965*^9, 3.864752520222987*^9, 3.8647558097767143`*^9, 
   3.864816466821233*^9, 3.864816531241448*^9, 3.864816562480658*^9, 
   3.864843585770279*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"974f6c3b-18a3-40bb-b3d8-31bba186a506"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"qstep", "=", "1."}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"size", " ", "of", " ", "q"}], "-", 
    RowBox[{
    "steps", " ", "in", " ", "units", " ", "of", " ", "\[CapitalDelta]k", " ",
      "spacings"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]qij", "=", 
   RowBox[{"{", 
    RowBox[{"0.", ",", "qstep"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]q", "=", 
   RowBox[{"Norm", "[", 
    RowBox[{"\[CapitalDelta]qij", ".", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["kk", "n"], ",", 
       FractionBox["kp", "n"]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Lq", "=", 
  RowBox[{"\[CapitalDelta]q", "*", "Nq"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qi", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"0.", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Lq"}], "/", "2"}], ")"}]}], "+", 
        RowBox[{"i", " ", "\[CapitalDelta]q"}]}], ",", "0."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "Nq"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPi]q0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "Nq"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kpij", "=", "k0ij"}], ";"}]}], "Input",
 CellChangeTimes->{{3.864215783621567*^9, 3.864215787696707*^9}, {
   3.864216771544289*^9, 3.8642167720117807`*^9}, {3.86421682286233*^9, 
   3.8642168375981903`*^9}, {3.864217542657886*^9, 3.86421756295612*^9}, {
   3.864217681225676*^9, 3.8642176870635138`*^9}, {3.864220659835087*^9, 
   3.864220685160924*^9}, {3.8642213061935053`*^9, 3.864221306293057*^9}, {
   3.864231182332857*^9, 3.864231184292848*^9}, {3.86423121608608*^9, 
   3.864231230167212*^9}, {3.8642329006852083`*^9, 3.864232901254257*^9}, {
   3.864233019099346*^9, 3.864233019386078*^9}, {3.864233070685137*^9, 
   3.864233070979928*^9}, {3.8642331277788267`*^9, 3.864233130404643*^9}, {
   3.8642332386354113`*^9, 3.864233252714081*^9}, {3.864235142820402*^9, 
   3.864235143360218*^9}, {3.864235366795061*^9, 3.864235370512504*^9}, {
   3.864235448093186*^9, 3.864235493292266*^9}, {3.864235554148144*^9, 
   3.864235565541422*^9}, {3.8642356602126637`*^9, 3.864235707131094*^9}, {
   3.864235759783558*^9, 3.8642357669899178`*^9}, {3.8642358153036423`*^9, 
   3.8642358762015047`*^9}, {3.8642359210273743`*^9, 
   3.8642359288429937`*^9}, {3.864236783638887*^9, 3.864236783695797*^9}, {
   3.864238146905451*^9, 3.864238147021923*^9}, {3.864299782701407*^9, 
   3.864299782836472*^9}, {3.864302427466052*^9, 3.864302427708617*^9}, {
   3.8643235545481777`*^9, 3.864323564068159*^9}, {3.8643236091022453`*^9, 
   3.864323613230287*^9}, {3.864388622512226*^9, 3.864388626807991*^9}, {
   3.864391127335803*^9, 3.864391158941051*^9}, {3.864392777685182*^9, 
   3.864392778906104*^9}, {3.864473430571097*^9, 3.864473430849464*^9}, {
   3.864474975782381*^9, 3.864474976925252*^9}, 3.8644929346394987`*^9, 
   3.8644929793007183`*^9, {3.864493105475727*^9, 3.864493105752316*^9}, {
   3.8644932738421926`*^9, 3.8644932979175243`*^9}, 3.864750136440464*^9, 
   3.864755813761489*^9},
 Background->RGBColor[1, 0.9, 1],
 CellLabel->
  "In[109]:=",ExpressionUUID->"de82f6d1-318a-4fb6-a5f0-50ba74ad770d"],

Cell[BoxData["1.7027602458481261`"], "Output",
 CellChangeTimes->{3.8647558144000597`*^9, 3.864816474335788*^9, 
  3.864816533266663*^9, 3.864816564884982*^9, 3.8648435890595703`*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"83f14057-f586-497c-a27d-267abe9afc7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Nq", "/", "qstep"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q", "=", 
          RowBox[{"i", " ", "\[CapitalDelta]q"}]}], ";", "  ", 
         RowBox[{"(*", 
          RowBox[{
          "Used", " ", "for", " ", "progress", " ", "bar", " ", "only"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Ekq", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Ek0ij", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"#1", "+", 
                   RowBox[{"(", 
                    RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
                  RowBox[{"#2", "-", "j0", "-", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "-", "#1"}]}], 
                    "]"}]}]}], "]"}], "]"}], " ", "&"}], ",", "kpij", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Psi]kq", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Psi]k0ij", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"#1", "+", 
                   RowBox[{"(", 
                    RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
                  RowBox[{"#2", "-", "j0", "-", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "-", "#1"}]}], 
                    "]"}]}]}], "]"}], "]"}], " ", "&"}], ",", "kpij", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nfEkq", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nfEk0ij", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"#1", "+", 
                   RowBox[{"(", 
                    RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
                  RowBox[{"#2", "-", "j0", "-", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "\[Lambda]"}], ")"}]}], "-", "#1"}]}], 
                    "]"}]}]}], "]"}], "]"}], " ", "&"}], ",", "kpij", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]nf", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Tuples", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"nfEk", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"nfEkq", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "-", 
              RowBox[{
               RowBox[{"Tuples", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"nfEk", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"nfEkq", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "nfEk", "]"}]}], "}"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]E", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Ek", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"Ekq", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "-", 
               RowBox[{
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Ek", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"Ekq", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "Ek", "]"}]}], "}"}]}], "]"}], "]"}], 
           "+", "\[Omega]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"+", "\[ImaginaryI]"}], "*", "\[Eta]"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[Psi]Tuples", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Psi]k", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"\[Psi]kq", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[Conjugate]"}]}], "}"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "Ek", "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Fkq", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Psi]Tuples", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Psi]Tuples", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "2"], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "Ek", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               SuperscriptBox["Nb", "2"]}], "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"idiv", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Abs", "[", "\[CapitalDelta]E", "]"}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "==", "0."}], "&"}], ")"}]}]}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalDelta]E", "[", 
           RowBox[{"[", "idiv", "]"}], "]"}], "=", "1."}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalDelta]nf", "[", 
           RowBox[{"[", "idiv", "]"}], "]"}], "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Delta]Fif", "[", "#", "]"}], "&"}], ",", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Tuples", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Ek", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"Ekq", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", "Ek", "]"}]}], "}"}]}], "]"}], "]"}],
              "[", 
             RowBox[{"[", "idiv", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalPi]q0", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"2", "/", 
              RowBox[{"Length", "[", "Ek", "]"}]}], ")"}]}], "*", 
           RowBox[{"Total", "[", 
            RowBox[{"\[CapitalDelta]nf", "*", 
             RowBox[{"Re", "[", 
              RowBox[{"1", "/", "\[CapitalDelta]E"}], "]"}], "*", "Fkq"}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"kqij", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", 
               RowBox[{"#2", "+", "1"}]}], "}"}], "&"}], ",", "kpij", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"kqijP3", "=", 
          RowBox[{"kqij", "-", 
           RowBox[{"P3", "[", "kqij", "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"kpij", "=", 
          RowBox[{"kqijP3", "-", 
           RowBox[{"P1", "[", "kqijP3", "]"}], "-", 
           RowBox[{"P2", "[", "kqijP3", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Progress:\>\"", ",", 
               RowBox[{"Darker", "[", 
                RowBox[{"Blue", ",", "0.66"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"ProgressIndicator", "[", 
             RowBox[{"q", ",", 
              RowBox[{"{", 
               RowBox[{"0.", ",", 
                RowBox[{"Lq", "*", 
                 RowBox[{"1.05", "/", "qstep"}]}]}], "}"}]}], "]"}], ",", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<``%\>\"", ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"100", "*", 
                 RowBox[{"q", "/", 
                  RowBox[{"(", 
                   RowBox[{"Lq", "*", 
                    RowBox[{"1.05", "/", "qstep"}]}], ")"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Current value of q: \>\"", ",", 
               RowBox[{"Darker", "[", 
                RowBox[{"Blue", ",", "0.66"}], "]"}]}], "]"}], "]"}], ",", 
            "q", " ", ",", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<Final value: ``\>\"", ",", 
              RowBox[{"NumberForm", "[", "Lq", "]"}]}], "]"}]}], " ", "}"}]}],
          "}"}], ",", 
        RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
        RowBox[{"Dividers", "\[Rule]", "Center"}]}], "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ListPlot", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Re", "[", 
          RowBox[{"\[CapitalPi]q0", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "Nq"}], "}"}]}], "]"}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"qi", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"Re", "[", 
           RowBox[{"\[CapitalPi]q0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", " ", "Nq"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}], 
      RowBox[{"(*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", "0.2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "200"}], "}"}]}], "}"}], "*)"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", " ", "Purple"}], ",", 
      RowBox[{"Joined", "\[Rule]", "False"}], ",", 
      RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<q [\!\(\*SuperscriptBox[\(\[Angstrom]\), \(-1\)]\)]\>\"", ",", 
         RowBox[{
         "-", "\"\<\[CapitalPi](q) [\!\(\*SuperscriptBox[\(eV\), \(-1\)]\)]\>\
\""}]}], "}"}]}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", "15", ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"Style", "[", "\"\<Polarizability at VHS\>\"", "]"}]}]}], 
     "]"}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.864216978387285*^9, 3.8642170011776648`*^9}, {
   3.864217142245501*^9, 3.86421714426542*^9}, {3.8642171810804577`*^9, 
   3.8642172460838547`*^9}, {3.864217284203371*^9, 3.864217370970665*^9}, {
   3.864217530111623*^9, 3.8642175485337687`*^9}, {3.864217644586897*^9, 
   3.8642176582972097`*^9}, {3.864218188997202*^9, 3.864218221853608*^9}, {
   3.8642182650729637`*^9, 3.8642183296332207`*^9}, 3.864218475092202*^9, {
   3.864219087160275*^9, 3.8642191031767597`*^9}, {3.864219444102606*^9, 
   3.864219450974667*^9}, {3.864220583416828*^9, 3.8642205861766253`*^9}, {
   3.864220621050281*^9, 3.8642206553384647`*^9}, {3.8642207277966537`*^9, 
   3.864220729683489*^9}, {3.8642208010158567`*^9, 3.864220912329031*^9}, {
   3.86422132744473*^9, 3.864221330919388*^9}, {3.864227883795308*^9, 
   3.864227887097252*^9}, {3.8642283151832647`*^9, 3.864228424410136*^9}, {
   3.8642284934777718`*^9, 3.864228614977501*^9}, {3.864228655911743*^9, 
   3.864228712165866*^9}, {3.864228877142453*^9, 3.864228885268116*^9}, {
   3.8642290340410547`*^9, 3.8642290875283747`*^9}, {3.864229232643064*^9, 
   3.864229309289608*^9}, {3.864229364432955*^9, 3.86422943890933*^9}, {
   3.8642294746897383`*^9, 3.8642295420643187`*^9}, {3.8642295789863157`*^9, 
   3.864229649836912*^9}, {3.864229715920856*^9, 3.86422975396694*^9}, {
   3.864229872512823*^9, 3.864229888571911*^9}, {3.864229926791479*^9, 
   3.86422993519725*^9}, {3.864230331547317*^9, 3.8642303458185368`*^9}, {
   3.8642305597736683`*^9, 3.8642305840846977`*^9}, {3.864231200122901*^9, 
   3.8642312101686087`*^9}, {3.864231244203417*^9, 3.864231244713278*^9}, {
   3.864231340060689*^9, 3.8642313448211117`*^9}, {3.8642314248635473`*^9, 
   3.864231525395533*^9}, 3.8642315690415983`*^9, {3.864231655441077*^9, 
   3.864231656990752*^9}, 3.864231707451573*^9, {3.864231744099774*^9, 
   3.864231763571929*^9}, {3.864231804911372*^9, 3.864231835688271*^9}, {
   3.86423188001801*^9, 3.864231947609095*^9}, 3.864232008503971*^9, {
   3.864232055670371*^9, 3.8642320979383373`*^9}, 3.8642321394696417`*^9, {
   3.8642321889701357`*^9, 3.8642321961539497`*^9}, {3.8642322576616573`*^9, 
   3.864232321079562*^9}, {3.864232422465886*^9, 3.864232517180641*^9}, {
   3.8642325824993467`*^9, 3.864232592664504*^9}, {3.8642326239124002`*^9, 
   3.8642326304320707`*^9}, {3.8642326620579233`*^9, 3.864232683170892*^9}, {
   3.864232728176714*^9, 3.864232785737574*^9}, {3.8642328161345797`*^9, 
   3.864232838601828*^9}, {3.864232872915094*^9, 3.864232896296983*^9}, {
   3.86423293527031*^9, 3.864232956407466*^9}, {3.864233146381209*^9, 
   3.864233151811784*^9}, {3.864233539812809*^9, 3.864233555401203*^9}, {
   3.864233759547352*^9, 3.86423380196471*^9}, {3.864234059741227*^9, 
   3.864234060883338*^9}, {3.864234166920321*^9, 3.864234170591028*^9}, {
   3.8642356666578407`*^9, 3.86423566813441*^9}, {3.864235959130188*^9, 
   3.8642359636006947`*^9}, {3.8642361580730743`*^9, 3.864236232618925*^9}, 
   3.86423630755799*^9, {3.864322731373946*^9, 3.864322743913797*^9}, 
   3.864322930623097*^9, 3.86432302305867*^9, {3.86432309936694*^9, 
   3.864323137655693*^9}, {3.864323179256508*^9, 3.864323179943317*^9}, {
   3.864323224304237*^9, 3.864323236071808*^9}, 3.864323414080558*^9, {
   3.8643234948863163`*^9, 3.864323518806859*^9}, {3.864389335155963*^9, 
   3.864389337355342*^9}, {3.864391181995504*^9, 3.864391195972118*^9}, {
   3.864392835024522*^9, 3.8643928427599497`*^9}, {3.864399924352809*^9, 
   3.8643999317521276`*^9}, {3.864472646926804*^9, 3.8644726521793013`*^9}, {
   3.864486795717729*^9, 3.864486797020174*^9}, {3.864489405616432*^9, 
   3.864489409967923*^9}, {3.8644929565043488`*^9, 3.864492969967437*^9}, {
   3.864749210409978*^9, 3.8647492820536127`*^9}, {3.864749747844446*^9, 
   3.864749778460412*^9}, {3.864749919105611*^9, 3.864750025228388*^9}, {
   3.864750092358472*^9, 3.8647501127916*^9}, 3.864750434534647*^9, {
   3.8647507602436523`*^9, 3.864750833767928*^9}, {3.864750947381895*^9, 
   3.8647509950286703`*^9}, {3.864755828234747*^9, 3.864755850468663*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[117]:=",ExpressionUUID->"4db296c7-6d1b-4399-8b05-3d4c1ec7bbec"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.5, 0, 0.5], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{0., 5.651092432136643*^-31}, {0.3405520491696252, 
     0.21574579261002225`}, {0.6811040983392505, 0.36009751165434484`}, {
     1.0216561475088757`, 0.48226110561207985`}, {1.362208196678501, 
     0.611762276061613}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      RowBox[{
       "-", "\"\[CapitalPi](q) [\\!\\(\\*SuperscriptBox[\\(eV\\), \
\\(-1\\)]\\)]\""}], TraditionalForm], None}, {
     FormBox[
     "\"q [\\!\\(\\*SuperscriptBox[\\(\[Angstrom]\\), \\(-1\\)]\\)]\"", 
      TraditionalForm], None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  LabelStyle->Directive[
    GrayLevel[0], 15, FontFamily -> "Times"],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    StyleBox["\"Polarizability at VHS\"", StripOnInput -> False], 
    TraditionalForm],
  PlotRange->{{0, 1.362208196678501}, {0, 0.611762276061613}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8647508022535133`*^9, 3.864750834335816*^9}, {
   3.864750949103717*^9, 3.864751002547797*^9}, 3.8647510490038433`*^9, 
   3.864751164100636*^9, 3.864751542197654*^9, 3.864754726116378*^9, {
   3.864755825432955*^9, 3.864755859140338*^9}, 3.8648164772519197`*^9, 
   3.86481653633951*^9, 3.8648166029928207`*^9, 3.8648435910678673`*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"74c87cf8-1e43-40f3-b182-f46ff57aaa19"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"qi", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"Re", "[", 
         RowBox[{"\[CapitalPi]q0", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", " ", "Nq"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", " ", "All"}], 
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.", ",", "0.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "200"}], "}"}]}], "}"}], "*)"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", " ", "Purple"}], ",", 
    RowBox[{"Joined", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<q [\!\(\*SuperscriptBox[\(\[Angstrom]\), \(-1\)]\)]\>\"", ",", 
       RowBox[{
       "-", "\"\<\[CapitalPi](q) [\!\(\*SuperscriptBox[\(eV\), \
\(-1\)]\)]\>\""}]}], "}"}]}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "15", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", "\"\<Polarizability at VHS\>\"", "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.864235335570993*^9, 3.864235336023171*^9}, {
   3.8643996190533743`*^9, 3.864399645340878*^9}, 3.864483719543414*^9, {
   3.864483753326688*^9, 3.864483937883213*^9}, {3.8644840741522627`*^9, 
   3.864484097850574*^9}, {3.864484128662463*^9, 3.864484129237719*^9}, {
   3.864484164125885*^9, 3.864484349538287*^9}, {3.864486750745633*^9, 
   3.864486770400744*^9}, {3.864489423715563*^9, 3.8644894445292683`*^9}, {
   3.864491893044063*^9, 3.864491894673892*^9}, {3.8644925537776623`*^9, 
   3.86449256305618*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[67]:=",ExpressionUUID->"eb89465f-199a-4100-90db-8b7999dcd2c2"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8648433821485*^9, 
  3.864843382151929*^9}},ExpressionUUID->"f8f8e6b7-41d4-48ac-a7f4-\
09bb637df863"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8647558577704487`*^9, 
  3.86475585777505*^9}},ExpressionUUID->"e1d553e2-7966-4164-9f29-\
3ecbe7c36518"]
},
NotebookAutoSave->True,
EvaluationCompletionAction->"ShowTiming",
WindowSize->{1228.5, 739.5},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
Magnification:>1.1 Inherited,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"348a7c7b-149c-4d1f-bac3-fdbe991d317e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 128, 1, 33, "Input",ExpressionUUID->"bff85224-bb18-4b30-a812-19ac33705938"],
Cell[CellGroupData[{
Cell[711, 25, 24814, 559, 1342, "Input",ExpressionUUID->"abb95b15-8003-42ef-9f07-b46c5ca7ad24"],
Cell[25528, 586, 1268, 19, 59, "Output",ExpressionUUID->"43057a04-f22f-4c9e-a1bc-80bf732c5b6d"]
}, Open  ]],
Cell[26811, 608, 268, 5, 98, "Input",ExpressionUUID->"c0aad437-a457-4357-80e5-79dd5f270198"],
Cell[CellGroupData[{
Cell[27104, 617, 11099, 245, 1156, "Input",ExpressionUUID->"593f9408-4163-46e8-9494-92e77893cb3a"],
Cell[38206, 864, 2775, 46, 263, "Output",ExpressionUUID->"42f2a8e5-fecc-4c8c-b290-a2497832d2b3"],
Cell[40984, 912, 2786, 47, 263, "Output",ExpressionUUID->"ab91bef5-e111-4dd4-bb5b-19e5b42d4d3e"],
Cell[43773, 961, 2790, 47, 263, "Output",ExpressionUUID->"dbe9244a-d444-446f-841d-6cbab7fa997d"]
}, Open  ]],
Cell[46578, 1011, 150, 3, 33, "Input",ExpressionUUID->"c82ea273-31cb-4a12-a29e-1fc46c08bd57"],
Cell[46731, 1016, 128, 3, 33, "Input",ExpressionUUID->"1e933596-729d-4d82-a4e5-9ab0df649604"],
Cell[46862, 1021, 6022, 167, 463, "Input",ExpressionUUID->"d355315d-1177-42f3-a64b-84b013f8f6ec"],
Cell[52887, 1190, 2505, 74, 168, "Input",ExpressionUUID->"bd4c15dd-fd08-4bf9-b336-d5d98f1ecea1"],
Cell[55395, 1266, 6651, 149, 215, "Input",ExpressionUUID->"f27b4035-8b37-4f27-86ca-6c0753b92226"],
Cell[CellGroupData[{
Cell[62071, 1419, 3300, 83, 168, "Input",ExpressionUUID->"27b85d38-d1c7-43e8-b3df-4d23b1fa7169"],
Cell[65374, 1504, 2808, 57, 282, "Output",ExpressionUUID->"974f6c3b-18a3-40bb-b3d8-31bba186a506"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68219, 1566, 3550, 79, 233, "Input",ExpressionUUID->"de82f6d1-318a-4fb6-a5f0-50ba74ad770d"],
Cell[71772, 1647, 266, 4, 52, "Output",ExpressionUUID->"83f14057-f586-497c-a27d-267abe9afc7f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72075, 1656, 18872, 425, 886, "Input",ExpressionUUID->"4db296c7-6d1b-4399-8b05-3d4c1ec7bbec"],
Cell[90950, 2083, 2198, 56, 341, "Output",ExpressionUUID->"74c87cf8-1e43-40f3-b182-f46ff57aaa19"]
}, Open  ]],
Cell[93163, 2142, 2153, 50, 103, "Input",ExpressionUUID->"eb89465f-199a-4100-90db-8b7999dcd2c2"],
Cell[95319, 2194, 150, 3, 33, InheritFromParent,ExpressionUUID->"f8f8e6b7-41d4-48ac-a7f4-09bb637df863"],
Cell[95472, 2199, 153, 3, 33, "Input",ExpressionUUID->"e1d553e2-7966-4164-9f29-3ecbe7c36518"]
}
]
*)

